### **🔹 프로시저(Procedure)란?**

- *프로시저(Procedure)**는 **데이터베이스에서 실행할 수 있는 SQL 문들의 집합(일종의 함수)**입니다.

일반적으로 **반복적으로 수행해야 하는 SQL 작업을 미리 저장**해 두고, 필요할 때 호출하여 실행할 수 있습니다.

---

## **🔹 프로시저의 특징**

1. **미리 컴파일되어 저장됨**
    - SQL 문을 여러 번 실행하는 것보다 속도가 빠름
    - 데이터베이스 서버에서 실행되므로, 클라이언트와 서버 간 트래픽 감소
2. **코드 재사용 가능**
    - 동일한 SQL 로직을 여러 번 사용할 경우, **SQL 문을 재사용할 수 있어 코드 중복을 방지**함
3. **트랜잭션 처리 가능**
    - 여러 개의 SQL 문을 한 번에 실행하고, 필요 시 `COMMIT` 또는 `ROLLBACK`을 통해 트랜잭션을 제어 가능
4. **입력(매개변수) 및 출력(반환값) 지원**
    - 프로시저는 입력값(`IN`), 출력값(`OUT`), 입출력값(`INOUT`)을 가질 수 있음

---

## **🔹 프로시저 기본 문법**

### **✅ 1. 프로시저 생성 (CREATE PROCEDURE)**

```sql
sql
복사편집
DELIMITER $$  -- 여러 줄 실행을 위한 구분자 설정
CREATE PROCEDURE getUserInfo(IN userId INT)
BEGIN
    SELECT * FROM users WHERE id = userId;
END $$
DELIMITER ;  -- 기본 구분자로 복구

```

📌 **설명**

- `CREATE PROCEDURE getUserInfo(IN userId INT)` → `userId`를 입력받는 프로시저 생성
- `SELECT * FROM users WHERE id = userId;` → 해당 `userId`에 해당하는 사용자 정보 조회
- `DELIMITER $$` → 여러 줄의 SQL 문을 실행하기 위한 설정 (MySQL에서 사용)

---

### **✅ 2. 프로시저 실행 (CALL)**

```sql
sql
복사편집
CALL getUserInfo(5);

```

- `5`라는 값을 매개변수로 전달하여 `id = 5`인 사용자를 조회

---

### **✅ 3. 프로시저 삭제 (DROP)**

```sql
sql
복사편집
DROP PROCEDURE IF EXISTS getUserInfo;

```

- 프로시저가 존재하면 삭제함

---

## **🔹 프로시저의 입출력 매개변수**

| **매개변수 유형** | **설명** |
| --- | --- |
| **IN** | 입력 값 (외부에서 값을 받아서 사용) |
| **OUT** | 출력 값 (프로시저 실행 후 결과를 반환) |
| **INOUT** | 입력과 출력을 모두 수행 |

---

### **✅ 4. 프로시저에 입력(IN)과 출력(OUT) 매개변수 사용**

```sql
sql
복사편집
DELIMITER $$
CREATE PROCEDURE getUserName(IN userId INT, OUT userName VARCHAR(50))
BEGIN
    SELECT name INTO userName FROM users WHERE id = userId;
END $$
DELIMITER ;

```

📌 **설명**

- `IN userId INT` → 사용자의 ID를 입력받음
- `OUT userName VARCHAR(50)` → 사용자 이름을 출력값으로 반환
- `SELECT name INTO userName FROM users WHERE id = userId;` → SQL 실행 결과를 `userName` 변수에 저장

### **✅ 5. 프로시저 호출 (출력값 받기)**

```sql
sql
복사편집
CALL getUserName(5, @name);
SELECT @name;

```

📌 **설명**

- `CALL getUserName(5, @name);` → ID가 `5`인 사용자의 이름을 `@name` 변수에 저장
- `SELECT @name;` → 저장된 값 출력

---

## **🔹 프로시저 활용 예시**

### **✅ 6. 회원 정보 업데이트 프로시저**

```sql
sql
복사편집
DELIMITER $$
CREATE PROCEDURE updateUserEmail(IN userId INT, IN newEmail VARCHAR(100))
BEGIN
    UPDATE users SET email = newEmail WHERE id = userId;
END $$
DELIMITER ;

```

📌 **설명**

- `updateUserEmail` 프로시저를 생성하여 특정 사용자의 이메일을 업데이트함

### **🔹 실행 예시**

```sql
sql
복사편집
CALL updateUserEmail(5, 'newemail@example.com');

```

- ID가 `5`인 사용자의 이메일을 `newemail@example.com`으로 변경

---

## **🔹 프로시저 vs. 함수의 차이**

| **구분** | **프로시저 (Procedure)** | **함수 (Function)** |
| --- | --- | --- |
| **목적** | 여러 개의 SQL 실행 | 단일 값 반환 |
| **반환 값** | 여러 개의 결과 가능 (`OUT` 사용) | 반드시 하나의 값 반환 |
| **사용 가능 위치** | 단독 실행 가능 | SELECT 문에서 사용 가능 |
| **트랜잭션** | `COMMIT`, `ROLLBACK` 사용 가능 | 불가능 |

### **🔹 예시**

- **프로시저:** 데이터를 삽입, 수정, 삭제하는 데 주로 사용
- **함수:** 특정 값을 계산하여 반환하는 데 사용 (예: `SUM()`, `AVG()`와 같은 집계 함수)

---

## **🔹 결론**

✅ **프로시저는 SQL 문을 묶어 저장해 두고 필요할 때 호출하여 실행하는 기능**입니다.

✅ **반복적으로 수행하는 SQL 작업을 쉽게 실행하고, 속도를 향상시킬 수 있음**.

✅ **트랜잭션 관리가 가능하며, IN/OUT 매개변수를 사용하여 데이터 처리 및 반환 가능**.

✅ **함수(Function)와 달리 여러 개의 SQL 문을 실행하고, 반드시 값을 반환할 필요가 없음**.
